# Reactアプリにstripe決済機能を追加してみる
stripeからAPIキーを取得して、メモをしながらecアプリに
決済機能を追加していこうと思います。
拙い点が多々あるかと思われますので、実装に取り組みたい方は
あくまで参考程度にしていただく様お願いします。

## stripeの基礎知識
### stripeとは
- オンライン決済のプラットフォーム
- 主要カード会社を網羅<br>
(VISA/MasterCard/AMEX/Discover/DinersClub/JCB
※JCBのみ申請が必要)
- デベロッパーファーストで複数の開発言語APIをサポートしている<br>
(Ruby,Python,PHP,Java,Node.js,Go,.NET)<br>
(何かしらのバックエンド言語を触ることになる...)<br>
[stripe APIリファレンス](https://stripe.com/docs/api)

### stripeの良さ
- 決済手数料が3.6%のみと安価<br>
(paypalの場合40円が上乗せされる)
> paypal例）国内の取引で、1カ月に10,000円の決済が10回行われた場合の手数料<br>
>（ 取引金額 1 万円 x 決済手数料 3.6 % + 40 円 / 件 ）x 10 回 = 手数料 4,000 円
- 開発者様のAPIドキュメントが豊富
- カード情報はStripe社が保持している<br>
(ユーザのカード情報を持つ責任はとても大きい、会社で持ってくれるのはとても便利)
- サブスクリプション(定期支払)の対応が用意
- オーソリ(与信確保)がとても便利
> オーソリ = Authorization

### stripe決済の仕組み
- カード情報を生で持たずにトークン化する
- stripe社のサーバーにカード情報を保存しない
(カード情報はstripe社で保持していると言ったが、自社サーバに格納しているわけでは無い)<br>
> **手順**
>1. Stripe.js & Elements（Checkout）を利用してブラウザから直接 Stripe へ決済（カード）情報を渡す
>2. Stripe のサーバからフロントエンドにトークンが返ってくる
>3. トークンを自身のサーバへ送る
>4. Charge / Customer のリクエストをサーバから送る（決済する / 決済情報を保存する）
>5. Stripe からのレスポンスを受ける<br>

引用元: https://qiita.com/y_toku/items/7e51ef7e69d7cbbfb3ca 

### アカウントを作成する
1. 以下にアクセスしてサインアップします<br>
https://dashboard.stripe.com/register
2. stripeダッシュボード画面に遷移します。
   (メールアドレスの確認を求められるため、確認しましょう)
   基本的にダッシュボードから購入履歴や顧客情報の管理が行えます。
3. APIキーを取得します。
   「APIキーの取得」からテストAPIキーを表示させます。
   以下の２つをコピーし、あとで使える様にしておきます。(再生成ができません)
    - 公開可能キー
    - シークレットキー 

※基本的には上記でOKですが、法人で使用する場合は「ビジネスの詳細情報を有効化してアカウントを追加する」
に進み、アカウント有効化後に「本番用APIキーの取得」を行う必要があります。

## 決済フォームを作る

## クレジットカードを登録する

## クレジットカードを編集する

## テスト決済をする

## 決済後に領収書をメール送信する